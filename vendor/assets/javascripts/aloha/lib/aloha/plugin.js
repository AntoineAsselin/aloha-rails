
define(['aloha/core','jquery','util/class','aloha/pluginmanager','aloha/console'],function(Aloha,jQuery,Class,PluginManager,console){"use strict";var Plugin=Class.extend({name:null,defaults:{},settings:{},dependencies:[],_constructor:function(name){if(typeof name!=="string"){console.error('Cannot initialise unnamed plugin, skipping');}else{this.name=name;}},checkDependencies:function(){var plugin=this;var satisfied=true;jQuery.each(plugin.dependencies,function(i,dependency){if(!Aloha.isPluginLoaded(dependency.toString())){satisfied=false;console.error('plugin.'+plugin.name,'Required plugin "'+dependency+'" not found.');return false;}});return satisfied;},init:function(){},getEditableConfig:function(obj){var configObj=null,configSpecified=false,that=this;if(this.settings.editables){jQuery.each(this.settings.editables,function(selector,selectorConfig){var k;if(obj.is(selector)){configSpecified=true;if(selectorConfig instanceof Array){configObj=[];configObj=jQuery.merge(configObj,selectorConfig);}else if(typeof selectorConfig==="object"){configObj={};configObj['aloha-editable-selector']=selector;for(k in selectorConfig){if(selectorConfig.hasOwnProperty(k)){if(selectorConfig[k]instanceof Array){configObj[k]=selectorConfig[k];}else if(typeof selectorConfig[k]==="object"){configObj[k]={};configObj[k]=jQuery.extend(true,configObj[k],that.config[k],selectorConfig[k]);}else{configObj[k]=selectorConfig[k];}}}}else{configObj=selectorConfig;}}});}
if(!configSpecified){if(typeof this.settings.config==='undefined'||!this.settings.config){configObj=this.config;}else{configObj=this.settings.config;}}
return configObj;},makeClean:function(obj){},getUID:function(id){console.deprecated('plugin','getUID() is deprecated. Use plugin.name instead.');return this.name;},toString:function(){return this.name;},log:function(level,message){console.deprecated('plugin','log() is deprecated. Use Aloha.console instead.');console.log(level,this,message);}});Plugin.create=function(pluginName,definition){var pluginInstance=new(Plugin.extend(definition))(pluginName);pluginInstance.settings=jQuery.extendObjects(true,pluginInstance.defaults,Aloha.settings[pluginName]);PluginManager.register(pluginInstance);return pluginInstance;};return Plugin;});